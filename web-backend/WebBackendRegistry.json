{
  "package": {
    "name": "planarwar-web-backend",
    "runtime": "node",
    "stack": [
      "express",
      "postgres (via worldcore)"
    ],
    "version": "0.1.0"
  },
  "registryVersion": "1.0",
  "root": "web-backend",
  "services": {
    "web-backend.config.cityTier": {
      "class": null,
      "ctorArgs": [],
      "dependsOn": [
        "node:fs",
        "node:path",
        "web-backend.data.cityTierConfig",
        "web-backend.gameState",
        "web-backend.domain.resources"
      ],
      "kind": "module",
      "lifecycle": "singleton",
      "notes": [
        "Loads /web-backend/data/cityTierConfig.json from disk and caches it.",
        "City morph options and tier-up costs are defined here (and/or in the JSON file)."
      ],
      "owns": [
        "in-process CityTierConfig cache"
      ],
      "path": "web-backend/config/cityTierConfig.ts",
      "provides": [
        "getCityTierConfig()",
        "getTierConfig(tier)",
        "getMorphConfig()",
        "DEFAULT_MORPH_CONFIG"
      ],
      "service": "cityTier.config"
    },
    "web-backend.config.demo": {
      "class": null,
      "ctorArgs": [],
      "dependsOn": [],
      "kind": "module",
      "lifecycle": "static",
      "notes": [
        "Demo profile knobs for tick rate, starting resources, and mission pacing."
      ],
      "owns": [],
      "path": "web-backend/config.ts",
      "provides": [
        "demoProfile",
        "tickConfig",
        "startingResourcesConfig",
        "missionDurationConfig"
      ],
      "service": "demo.config"
    },
    "web-backend.data.cityTierConfig": {
      "class": null,
      "ctorArgs": [],
      "dependsOn": [],
      "kind": "data",
      "lifecycle": "static",
      "notes": [
        "Loaded by web-backend/config/cityTierConfig.ts."
      ],
      "owns": [],
      "path": "web-backend/data/cityTierConfig.json",
      "provides": [
        "City tier progression + morph configuration (JSON)"
      ],
      "service": "cityTier.data"
    },
    "web-backend.data.resources": {
      "class": null,
      "ctorArgs": [],
      "dependsOn": [],
      "kind": "data",
      "lifecycle": "static",
      "notes": [
        "Catalog JSON files for resource items (used by web-backend/domain/resources.ts).",
        "Note: luxury.json and black_market.json exist but are not in RESOURCE_DATA_FILES yet.",
        "Path stored as directory (not glob) so registryIndexPathsCheck can validate existence."
      ],
      "owns": [
        "web-backend.data.resources.food",
        "web-backend.data.resources.wood",
        "web-backend.data.resources.stone",
        "web-backend.data.resources.ore",
        "web-backend.data.resources.herbs",
        "web-backend.data.resources.fish",
        "web-backend.data.resources.mana",
        "web-backend.data.resources.luxury",
        "web-backend.data.resources.black_market"
      ],
      "path": "web-backend/data/resources",
      "provides": [
        "Resource item definitions for families: ore/stone/wood/herbs/food/fish/mana/luxury/black_market"
      ],
      "service": "resources.catalog"
    },
    "web-backend.data.resources.black_market": {
      "class": null,
      "ctorArgs": [],
      "dependsOn": [],
      "kind": "data",
      "lifecycle": "static",
      "notes": [
        "Not referenced by RESOURCE_DATA_FILES; currently unused unless loaded elsewhere."
      ],
      "owns": [],
      "path": "web-backend/data/resources/black_market.json",
      "provides": [
        "Resource item catalog (present; not currently loaded by domain/resources.ts)"
      ],
      "service": "data.resources"
    },
    "web-backend.data.resources.fish": {
      "class": null,
      "ctorArgs": [],
      "dependsOn": [],
      "kind": "data",
      "lifecycle": "static",
      "notes": [
        "Included in RESOURCE_DATA_FILES in domain/resources.ts."
      ],
      "owns": [],
      "path": "web-backend/data/resources/fish.json",
      "provides": [
        "Resource item catalog (loaded by domain/resources.ts)"
      ],
      "service": "data.resources"
    },
    "web-backend.data.resources.food": {
      "class": null,
      "ctorArgs": [],
      "dependsOn": [],
      "kind": "data",
      "lifecycle": "static",
      "notes": [
        "Included in RESOURCE_DATA_FILES in domain/resources.ts."
      ],
      "owns": [],
      "path": "web-backend/data/resources/food.json",
      "provides": [
        "Resource item catalog (loaded by domain/resources.ts)"
      ],
      "service": "data.resources"
    },
    "web-backend.data.resources.herbs": {
      "class": null,
      "ctorArgs": [],
      "dependsOn": [],
      "kind": "data",
      "lifecycle": "static",
      "notes": [
        "Included in RESOURCE_DATA_FILES in domain/resources.ts."
      ],
      "owns": [],
      "path": "web-backend/data/resources/herbs.json",
      "provides": [
        "Resource item catalog (loaded by domain/resources.ts)"
      ],
      "service": "data.resources"
    },
    "web-backend.data.resources.luxury": {
      "class": null,
      "ctorArgs": [],
      "dependsOn": [],
      "kind": "data",
      "lifecycle": "static",
      "notes": [
        "Not referenced by RESOURCE_DATA_FILES; currently unused unless loaded elsewhere."
      ],
      "owns": [],
      "path": "web-backend/data/resources/luxury.json",
      "provides": [
        "Resource item catalog (present; not currently loaded by domain/resources.ts)"
      ],
      "service": "data.resources"
    },
    "web-backend.data.resources.mana": {
      "class": null,
      "ctorArgs": [],
      "dependsOn": [],
      "kind": "data",
      "lifecycle": "static",
      "notes": [
        "Included in RESOURCE_DATA_FILES in domain/resources.ts."
      ],
      "owns": [],
      "path": "web-backend/data/resources/mana.json",
      "provides": [
        "Resource item catalog (loaded by domain/resources.ts)"
      ],
      "service": "data.resources"
    },
    "web-backend.data.resources.ore": {
      "class": null,
      "ctorArgs": [],
      "dependsOn": [],
      "kind": "data",
      "lifecycle": "static",
      "notes": [
        "Included in RESOURCE_DATA_FILES in domain/resources.ts."
      ],
      "owns": [],
      "path": "web-backend/data/resources/ore.json",
      "provides": [
        "Resource item catalog (loaded by domain/resources.ts)"
      ],
      "service": "data.resources"
    },
    "web-backend.data.resources.stone": {
      "class": null,
      "ctorArgs": [],
      "dependsOn": [],
      "kind": "data",
      "lifecycle": "static",
      "notes": [
        "Included in RESOURCE_DATA_FILES in domain/resources.ts."
      ],
      "owns": [],
      "path": "web-backend/data/resources/stone.json",
      "provides": [
        "Resource item catalog (loaded by domain/resources.ts)"
      ],
      "service": "data.resources"
    },
    "web-backend.data.resources.wood": {
      "class": null,
      "ctorArgs": [],
      "dependsOn": [],
      "kind": "data",
      "lifecycle": "static",
      "notes": [
        "Included in RESOURCE_DATA_FILES in domain/resources.ts."
      ],
      "owns": [],
      "path": "web-backend/data/resources/wood.json",
      "provides": [
        "Resource item catalog (loaded by domain/resources.ts)"
      ],
      "service": "data.resources"
    },
    "web-backend.domain.armies": {
      "class": null,
      "ctorArgs": [],
      "dependsOn": [],
      "kind": "module",
      "lifecycle": "static",
      "notes": [
        "Starter army generation for web-city-builder demo."
      ],
      "owns": [],
      "path": "web-backend/domain/armies.ts",
      "provides": [
        "seedStarterArmies(cityId)",
        "types: Army, ArmyType"
      ],
      "service": "domain.armies"
    },
    "web-backend.domain.city": {
      "class": null,
      "ctorArgs": [],
      "dependsOn": [
        "web-backend.config.cityTier"
      ],
      "kind": "module",
      "lifecycle": "static",
      "notes": [
        "City/building math and starter city seeding for the web-city-builder prototype."
      ],
      "owns": [],
      "path": "web-backend/domain/city.ts",
      "provides": [
        "seedStarterCity(ownerId)",
        "getBuildingProductionPerTick(building)",
        "getCityProductionPerTick(city)",
        "getBuildingUpgradeCost(building)",
        "getBuildingConstructionCost(kind, city)",
        "maxBuildingSlotsForTier(tier)",
        "createBuilding(kind, city)",
        "types: City, CityBuilding, BuildingProduction"
      ],
      "service": "domain.city"
    },
    "web-backend.domain.heroes": {
      "class": null,
      "ctorArgs": [],
      "dependsOn": [],
      "kind": "module",
      "lifecycle": "static",
      "notes": [
        "Starter hero generation for web-city-builder demo."
      ],
      "owns": [],
      "path": "web-backend/domain/heroes.ts",
      "provides": [
        "seedStarterHeroes(ownerId)",
        "types: Hero, HeroRole"
      ],
      "service": "domain.heroes"
    },
    "web-backend.domain.missions": {
      "class": null,
      "ctorArgs": [],
      "dependsOn": [
        "web-backend.domain.city",
        "web-backend.domain.resources"
      ],
      "kind": "module",
      "lifecycle": "static",
      "notes": [
        "Mission offer generation and reward/risk shaping for web-city-builder demo."
      ],
      "owns": [],
      "path": "web-backend/domain/missions.ts",
      "provides": [
        "generateMissionOffers(ctx)",
        "types: MissionOffer, RewardBundle, MissionDifficulty"
      ],
      "service": "domain.missions"
    },
    "web-backend.domain.resources": {
      "class": null,
      "ctorArgs": [],
      "dependsOn": [
        "node:fs",
        "node:path",
        "web-backend.data.resources.food",
        "web-backend.data.resources.wood",
        "web-backend.data.resources.stone",
        "web-backend.data.resources.ore",
        "web-backend.data.resources.herbs",
        "web-backend.data.resources.fish",
        "web-backend.data.resources.mana"
      ],
      "kind": "module",
      "lifecycle": "singleton",
      "notes": [
        "Loads resource JSON catalogs from /web-backend/data/resources/*.json and exposes lookup helpers.",
        "Loads a fixed set of JSON catalogs from RESOURCE_DATA_FILES; luxury/black_market are present but currently excluded."
      ],
      "owns": [
        "in-process resource catalog cache"
      ],
      "path": "web-backend/domain/resources.ts",
      "provides": [
        "getAllResourceItems()",
        "getResourceItemById(id)",
        "getResourceItemsByKey(key)",
        "addResources(target, delta)",
        "types: ResourceKey, ResourceVector"
      ],
      "service": "domain.resources"
    },
    "web-backend.domain.tech": {
      "class": null,
      "ctorArgs": [],
      "dependsOn": [],
      "kind": "module",
      "lifecycle": "static",
      "notes": [
        "Tech tree definitions and availability rules for web-city-builder demo."
      ],
      "owns": [],
      "path": "web-backend/domain/tech.ts",
      "provides": [
        "getAllTechDefs()",
        "getTechById(id)",
        "getAvailableTechsForPlayer(ctx)",
        "types: TechDefinition, TechAge, TechEpoch, TechCategory"
      ],
      "service": "domain.tech"
    },
    "web-backend.domain.world": {
      "class": null,
      "ctorArgs": [],
      "dependsOn": [],
      "kind": "module",
      "lifecycle": "static",
      "notes": [
        "Seeds the demo world map / regions for the web-city-builder prototype."
      ],
      "owns": [],
      "path": "web-backend/domain/world.ts",
      "provides": [
        "seedWorld()",
        "types: World, Shard, Region, RegionId"
      ],
      "service": "domain.world"
    },
    "web-backend.entry": {
      "class": null,
      "ctorArgs": [],
      "dependsOn": [
        "npm:express",
        "npm:cors",
        "npm:dotenv",
        "web-backend.routes.me",
        "web-backend.routes.missions",
        "web-backend.routes.city",
        "web-backend.routes.policies",
        "web-backend.routes.tech",
        "web-backend.routes.warfront",
        "web-backend.routes.armies",
        "web-backend.routes.garrisons",
        "web-backend.routes.buildings",
        "web-backend.routes.heroes",
        "web-backend.routes.workshop",
        "web-backend.routes.resources",
        "web-backend.routes.characters",
        "web-backend.routes.auth",
        "web-backend.routes.adminQuests",
        "web-backend.routes.adminNpcs",
        "web-backend.routes.adminItems",
        "web-backend.routes.adminSpawnPoints"
      ],
      "kind": "entrypoint",
      "lifecycle": "process",
      "notes": [
        "This server is a thin Express host that exposes both: (1) web-city-builder demo endpoints (gameState/domain/*), and (2) worldcore-backed admin APIs (quests/npcs/items/spawn_points/auth).",
        "Technical debt: index.ts mounts /api/characters twice (harmless but redundant)."
      ],
      "owns": [
        "Express app instance",
        "HTTP listen socket"
      ],
      "path": "web-backend/index.ts",
      "provides": [
        "GET / -> { ok: true, message: ... }",
        "Mount /api/me",
        "Mount /api/missions",
        "Mount /api/city",
        "Mount /api/policies",
        "Mount /api/tech",
        "Mount /api/warfront",
        "Mount /api/armies",
        "Mount /api/garrisons",
        "Mount /api/buildings",
        "Mount /api/heroes",
        "Mount /api/workshop",
        "Mount /api/resources",
        "Mount /api/characters",
        "Mount /api/auth",
        "Mount /api/admin/quests",
        "Mount /api/admin/npcs",
        "Mount /api/admin/items",
        "Mount /api/admin/spawn_points"
      ],
      "service": "http.server"
    },
    "web-backend.gameState": {
      "class": null,
      "ctorArgs": [],
      "dependsOn": [
        "web-backend.config.demo",
        "web-backend.config.cityTier",
        "web-backend.domain.world",
        "web-backend.domain.city",
        "web-backend.domain.heroes",
        "web-backend.domain.armies",
        "web-backend.domain.missions",
        "web-backend.domain.tech",
        "web-backend.domain.resources"
      ],
      "kind": "module",
      "lifecycle": "singleton",
      "notes": [
        "In-memory, demo-style state manager for the web-city-builder prototype.",
        "Routes call tickPlayerState(...) before reads/writes to keep time-based progression consistent.",
        "Now supports per-account CityBuilder state via getOrCreatePlayerState(playerId, displayName)."
      ],
      "owns": [
        "in-memory GameState (demo)",
        "in-memory GameState (demo, per-account states)"
      ],
      "path": "web-backend/gameState.ts",
      "provides": [
        "getGameState()",
        "getPlayerState(playerId)",
        "getOrCreatePlayerState(playerId, displayName?)",
        "getDemoPlayer()",
        "getDemoPlayerWithOffers()",
        "startMissionForPlayer(...)",
        "completeMissionForPlayer(...)",
        "regenerateRegionMissionsForPlayer(...)",
        "buildBuildingForPlayer(...)",
        "upgradeBuildingForPlayer(...)",
        "startResearchForPlayer(...)"
      ],
      "service": "demo.gameState"
    },
    "web-backend.package": {
      "class": null,
      "ctorArgs": [],
      "dependsOn": [],
      "kind": "data",
      "lifecycle": "static",
      "notes": [
        "Entry: dist/index.js. Scripts: dev/build/start."
      ],
      "owns": [],
      "path": "web-backend/package.json",
      "provides": [
        "npm package metadata + scripts"
      ],
      "service": "package.meta"
    },
    "web-backend.routes.adminItems": {
      "class": null,
      "ctorArgs": [],
      "dependsOn": [
        "npm:express",
        "worldcore:db/Database"
      ],
      "kind": "module",
      "lifecycle": "singleton",
      "notes": [
        "Admin item list + upsert backed by worldcore DB tables."
      ],
      "owns": [],
      "path": "web-backend/routes/adminItems.ts",
      "provides": [
        "GET /api/admin/items",
        "POST /api/admin/items"
      ],
      "service": "http.adminRoutes"
    },
    "web-backend.routes.adminNpcs": {
      "class": null,
      "ctorArgs": [],
      "dependsOn": [
        "npm:express",
        "worldcore:db/Database"
      ],
      "kind": "module",
      "lifecycle": "singleton",
      "notes": [
        "Admin NPC list + upsert backed by worldcore DB tables."
      ],
      "owns": [],
      "path": "web-backend/routes/adminNpcs.ts",
      "provides": [
        "GET /api/admin/npcs",
        "POST /api/admin/npcs"
      ],
      "service": "http.adminRoutes"
    },
    "web-backend.routes.adminQuests": {
      "class": null,
      "ctorArgs": [
        "PostgresQuestService()"
      ],
      "dependsOn": [
        "npm:express",
        "worldcore:db/Database",
        "worldcore:quests/PostgresQuestService",
        "worldcore:quests/QuestRegistry"
      ],
      "kind": "module",
      "lifecycle": "singleton",
      "notes": [
        "Admin quest list + upsert; reloads QuestRegistry in-process after changes."
      ],
      "owns": [
        "PostgresQuestService instance"
      ],
      "path": "web-backend/routes/adminQuests.ts",
      "provides": [
        "GET /api/admin/quests",
        "POST /api/admin/quests"
      ],
      "service": "http.adminRoutes"
    },
    "web-backend.routes.adminSpawnPoints": {
      "class": null,
      "ctorArgs": [],
      "dependsOn": [
        "npm:express",
        "worldcore:db/Database",
        "worldcore:world/SpawnPointCache",
        "worldcore:world/spawnAuthority",
        "worldcore:sim/MotherBrainWavePlanner",
        "worldcore:sim/MotherBrainWaveOps",
        "worldcore:sim/TownBaselinePlanner",
        "worldcore:world/TownTierRules"
      ],
      "kind": "module",
      "lifecycle": "singleton",
      "notes": [
        "Admin spawn point CRUD + batch operations.",
        "Mother Brain endpoints call into worldcore planner/ops and clear SpawnPointCache after mutations.",
        "Important invariant: brain-owned spawnIds are not editable through the admin UI (spawnAuthority enforcement).",
        "Town baseline endpoints call into worldcore TownBaselinePlanner and clear SpawnPointCache after commit.",
        "Mother Brain wave/wipe responses now include opsPreview (truncated spawnId lists) for UI diff preview/export.",
        "Town baseline plan/apply responses include opsPreview (insert/update/skip/readOnly spawnId lists, truncated) for UI diff previews."
      ],
      "owns": [],
      "path": "web-backend/routes/adminSpawnPoints.ts",
      "provides": [
        "GET /api/admin/spawn_points",
        "POST /api/admin/spawn_points (upsert)",
        "DELETE /api/admin/spawn_points/:id",
        "POST /api/admin/spawn_points/bulk_delete",
        "POST /api/admin/spawn_points/bulk_move",
        "POST /api/admin/spawn_points/clone",
        "POST /api/admin/spawn_points/scatter",
        "GET /api/admin/spawn_points/mother_brain/status",
        "POST /api/admin/spawn_points/mother_brain/wave",
        "POST /api/admin/spawn_points/mother_brain/wipe",
        "POST /api/admin/spawn_points/town_baseline/plan",
        "POST /api/admin/spawn_points/town_baseline/apply"
      ],
      "service": "http.adminRoutes"
    },
    "web-backend.routes.adminVendorAudit": {
      "class": null,
      "ctorArgs": [],
      "dependsOn": [
        "npm:express",
        "worldcore:db/Database"
      ],
      "kind": "module",
      "lifecycle": "singleton",
      "notes": [
        "Admin read-only viewer endpoint for vendor_log with filters + pagination."
      ],
      "owns": [],
      "path": "web-backend/routes/adminVendorAudit.ts",
      "provides": [
        "GET /api/admin/vendor_audit",
        "GET /api/admin/vendor_audit/csv"
      ],
      "service": "http.adminRoutes"
    },
    "web-backend.routes.adminVendorEconomy": {
      "class": null,
      "ctorArgs": [],
      "dependsOn": [
        "npm:express",
        "worldcore:db/Database"
      ],
      "kind": "module",
      "lifecycle": "singleton",
      "notes": [
        "Admin editor endpoints for vendor_item_economy (stock/restock/price multipliers) with optional stock reset."
      ],
      "owns": [],
      "path": "web-backend/routes/adminVendorEconomy.ts",
      "provides": [
        "GET /api/admin/vendor_economy/vendors",
        "GET /api/admin/vendor_economy/items",
        "POST /api/admin/vendor_economy/items/:vendorItemId"
      ],
      "service": "http.adminRoutes"
    },
    "web-backend.routes.armies": {
      "class": null,
      "ctorArgs": [],
      "dependsOn": [
        "npm:express",
        "web-backend.gameState"
      ],
      "kind": "module",
      "lifecycle": "singleton",
      "notes": [
        "Army raise/reinforce endpoints for demo city builder."
      ],
      "owns": [],
      "path": "web-backend/routes/armies.ts",
      "provides": [
        "POST /api/armies/raise",
        "POST /api/armies/reinforce"
      ],
      "service": "http.routes"
    },
    "web-backend.routes.auth": {
      "class": null,
      "ctorArgs": [
        "PostgresAuthService()"
      ],
      "dependsOn": [
        "npm:express",
        "worldcore:auth/PostgresAuthService"
      ],
      "kind": "module",
      "lifecycle": "singleton",
      "notes": [
        "Auth endpoints backed by worldcore auth service."
      ],
      "owns": [
        "PostgresAuthService instance"
      ],
      "path": "web-backend/routes/auth.ts",
      "provides": [
        "POST /api/auth/register",
        "POST /api/auth/login"
      ],
      "service": "http.routes"
    },
    "web-backend.routes.buildings": {
      "class": null,
      "ctorArgs": [],
      "dependsOn": [
        "npm:express",
        "web-backend.gameState"
      ],
      "kind": "module",
      "lifecycle": "singleton",
      "notes": [
        "Alternate building endpoints (construct/upgrade) for demo city builder."
      ],
      "owns": [],
      "path": "web-backend/routes/buildings.ts",
      "provides": [
        "POST /api/buildings/construct",
        "POST /api/buildings/upgrade"
      ],
      "service": "http.routes"
    },
    "web-backend.routes.characters": {
      "class": null,
      "ctorArgs": [],
      "dependsOn": [
        "npm:express",
        "worldcore:characters/PostgresCharacterService"
      ],
      "kind": "module",
      "lifecycle": "singleton",
      "notes": [
        "Worldcore-backed character CRUD and progression endpoints."
      ],
      "owns": [],
      "path": "web-backend/routes/characters.ts",
      "provides": [
        "GET /api/characters",
        "POST /api/characters",
        "GET /api/characters/:id",
        "POST /api/characters/:id/xp",
        "POST /api/characters/:id/learn-spell",
        "POST /api/characters/:id/equip"
      ],
      "service": "http.routes"
    },
    "web-backend.routes.city": {
      "class": null,
      "ctorArgs": [],
      "dependsOn": [
        "npm:express",
        "web-backend.gameState",
        "web-backend.config.cityTier"
      ],
      "kind": "module",
      "lifecycle": "singleton",
      "notes": [
        "City operations for demo city builder (build/upgrade/tier/morph).",
        "Supports Authorization: Bearer token; city builder endpoints resolve playerId from account id when authed, otherwise fall back to DEMO."
      ],
      "owns": [],
      "path": "web-backend/routes/city.ts",
      "provides": [
        "POST /api/city/upgrade-building",
        "POST /api/city/build",
        "POST /api/city/tier-up",
        "POST /api/city/morph"
      ],
      "service": "http.routes"
    },
    "web-backend.routes.garrisons": {
      "class": null,
      "ctorArgs": [],
      "dependsOn": [
        "npm:express",
        "web-backend.gameState"
      ],
      "kind": "module",
      "lifecycle": "singleton",
      "notes": [
        "Garrison strike endpoint for demo city builder."
      ],
      "owns": [],
      "path": "web-backend/routes/garrisons.ts",
      "provides": [
        "POST /api/garrisons/strike"
      ],
      "service": "http.routes"
    },
    "web-backend.routes.heroes": {
      "class": null,
      "ctorArgs": [],
      "dependsOn": [
        "npm:express",
        "web-backend.gameState"
      ],
      "kind": "module",
      "lifecycle": "singleton",
      "notes": [
        "Hero recruit + equipment endpoints for demo city builder."
      ],
      "owns": [],
      "path": "web-backend/routes/heroes.ts",
      "provides": [
        "POST /api/heroes/equip_attachment",
        "POST /api/heroes/recruit"
      ],
      "service": "http.routes"
    },
    "web-backend.routes.me": {
      "class": null,
      "ctorArgs": [],
      "dependsOn": [
        "npm:express",
        "web-backend.gameState"
      ],
      "kind": "module",
      "lifecycle": "singleton",
      "notes": [
        "Demo endpoint(s) for player state.",
        "Supports Authorization: Bearer token; if present+valid, /api/me returns the authenticated account id/displayName and uses per-account CityBuilder state.",
        "When authed, ensures a cities row exists for the account (DB-enforced: 1 city per account). Falls back to DEMO player when unauthenticated."
      ],
      "owns": [],
      "path": "web-backend/routes/me.ts",
      "provides": [
        "GET /api/me -> demo playerP state snapshot",
        "GET /api/me (auth-aware)"
      ],
      "service": "http.routes"
    },
    "web-backend.routes.missions": {
      "class": null,
      "ctorArgs": [],
      "dependsOn": [
        "npm:express",
        "web-backend.gameState"
      ],
      "kind": "module",
      "lifecycle": "singleton",
      "notes": [
        "Mission offer listing + start/complete for the demo city builder."
      ],
      "owns": [],
      "path": "web-backend/routes/missions.ts",
      "provides": [
        "GET /api/missions/offers",
        "POST /api/missions/start",
        "POST /api/missions/complete",
        "POST /api/missions/refresh_region"
      ],
      "service": "http.routes"
    },
    "web-backend.routes.policies": {
      "class": null,
      "ctorArgs": [],
      "dependsOn": [
        "npm:express",
        "web-backend.gameState"
      ],
      "kind": "module",
      "lifecycle": "singleton",
      "notes": [
        "Policy toggles for demo city builder."
      ],
      "owns": [],
      "path": "web-backend/routes/policies.ts",
      "provides": [
        "GET /api/policies",
        "POST /api/policies/toggle"
      ],
      "service": "http.routes"
    },
    "web-backend.routes.resources": {
      "class": null,
      "ctorArgs": [],
      "dependsOn": [
        "npm:express",
        "web-backend.gameState",
        "web-backend.domain.resources"
      ],
      "kind": "module",
      "lifecycle": "singleton",
      "notes": [
        "Resource mastery tier-up endpoint for demo city builder."
      ],
      "owns": [],
      "path": "web-backend/routes/resourceTierRoutes.ts",
      "provides": [
        "POST /api/resources/tier-up"
      ],
      "service": "http.routes"
    },
    "web-backend.routes.tech": {
      "class": null,
      "ctorArgs": [],
      "dependsOn": [
        "npm:express",
        "web-backend.gameState",
        "web-backend.domain.tech"
      ],
      "kind": "module",
      "lifecycle": "singleton",
      "notes": [
        "Tech start endpoint for demo city builder."
      ],
      "owns": [],
      "path": "web-backend/routes/tech.ts",
      "provides": [
        "POST /api/tech/start"
      ],
      "service": "http.routes"
    },
    "web-backend.routes.warfront": {
      "class": null,
      "ctorArgs": [],
      "dependsOn": [
        "npm:express",
        "web-backend.gameState"
      ],
      "kind": "module",
      "lifecycle": "singleton",
      "notes": [
        "Warfront assault endpoint for demo city builder."
      ],
      "owns": [],
      "path": "web-backend/routes/warfront.ts",
      "provides": [
        "POST /api/warfront/assault"
      ],
      "service": "http.routes"
    },
    "web-backend.routes.workshop": {
      "class": null,
      "ctorArgs": [],
      "dependsOn": [
        "npm:express",
        "web-backend.gameState"
      ],
      "kind": "module",
      "lifecycle": "singleton",
      "notes": [
        "Workshop crafting job endpoints for demo city builder."
      ],
      "owns": [],
      "path": "web-backend/routes/workshop.ts",
      "provides": [
        "POST /api/workshop/craft",
        "POST /api/workshop/collect"
      ],
      "service": "http.routes"
    }
  }
}
